var remoteItUtils={DEBUG:false,shouldWeHandleThisURL:function(a){if((this.url_utils.isProblemUrl(a)||this.url_utils.isJobUrl(a)||this.url_utils.isTaskUrl(a)||a.indexOf("workplace.plus.net")!=-1)&&a.indexOf("remote.plus.net")==-1){return true;}return false;},debug:function(a){if(this.DEBUG==true){}},url_utils:{remote_plus_net:"remote.plus.net",remote_plus_net_url_base:"https://remote.plus.net/",dana_info_handle:",DanaInfo=",ssl_handle:",SSL",problem_url:"https://remote.plus.net/programme_tool/,DanaInfo=workplace.plus.net,SSL+problem.html?problem_id=",job_url:"https://remote.plus.net/programme_tool/,DanaInfo=workplace.plus.net,SSL+job.html?job_id=",task_url:"https://remote.plus.net/programme_tool/,DanaInfo=workplace.plus.net,SSL+pr_edit_tasks.html?task_id=",deRemote:function(a){remoteItUtils.debug("DeRemote: "+a);var b=(this.shouldWeUseSSLForDeRemote(a)?"https://":"http://");return a.replace(/(ftp|http|https|file):\/\/remote.plus.net\//gim,"").replace(/^(.*?),DanaInfo=(.*?),SSL\+(.*?$)/gim,b+"$2/$1$3");},convert:function(a){remoteItUtils.debug("Convert: "+a);if(this.isProblemUrl(a)){remoteItUtils.debug("Convert problem URL");return this.getProblemUrl(a);}else{if(this.isJobUrl(a)){remoteItUtils.debug("Convert job URL");return this.getJobUrl(a);}else{if(this.isTaskUrl(a)){remoteItUtils.debug("Convert task URL");return this.getTaskUrl(a);}else{remoteItUtils.debug("Workplace URL");return this.getRemotedURL(a);}}}},getRemotedURL:function(b){var a=(this.shouldWeUseSSL(b)?this.ssl_handle:"");return this.remote_plus_net_url_base+b.replace(/(ftp|http|https|file):\/\//gim,"").replace(/^(.+?)\/(.*?\/?.*?)([^\/]*$)/gim,"$2"+this.dana_info_handle+"$1"+a+"+$3");},isProblemUrl:function(a){return a.replace(/(ftp|http|https|file):\/\//gim,"").search(/^(p|problem):[0-9]+.*?$/gim)!=-1;},isJobUrl:function(a){return a.replace(/(ftp|http|https|file):\/\//gim,"").search(/^(j|job):[0-9]+.*?$/gim)!=-1;},isTaskUrl:function(a){return a.replace(/(ftp|http|https|file):\/\//gim,"").search(/^(t|task):[0-9]+.*?$/gim)!=-1;},getProblemUrl:function(a){return this.problem_url+a.replace(/(ftp|http|https|file):\/\//gim,"").replace(/^.*?(p|problem):([0-9]+).*?/gim,"$2");},getJobUrl:function(a){return this.job_url+a.replace(/(ftp|http|https|file):\/\//gim,"").replace(/^.*?(j|job):([0-9]+).*?/gim,"$2");},getTaskUrl:function(a){return this.task_url+a.replace(/(ftp|http|https|file):\/\//gim,"").replace(/^.*?(t|task):([0-9]+).*?/gim,"$2");},shouldWeUseSSL:function(a){return a.indexOf("workplace.plus.net")!=-1;},shouldWeUseSSLForDeRemote:function(a){return a.indexOf(this.ssl_handle)!=-1;}},copyLinkToClipboard:function(e,h){var a=e;if(h==null){h=e;}var d=('<a href="'+e+'">'+h+"</a>");var g=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);if(!g){return false;}g.data=a;var f=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);if(!f){return false;}f.data=d;var b=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!b){return false;}b.addDataFlavor("text/unicode");b.setTransferData("text/unicode",g,a.length*2);b.addDataFlavor("text/html");b.setTransferData("text/html",f,d.length*2);var c=Components.classes["@mozilla.org/widget/clipboard;1"].getService(Components.interfaces.nsIClipboard);if(!c){return false;}c.setData(b,null,Components.interfaces.nsIClipboard.kGlobalClipboard);return true;}};var remoteit={onLoad:function(){this.initialized=true;this.strings=document.getElementById("remoteit-strings");remoteItUtils.DEBUG=(this.strings.getString("remoteItDebugMode")=="TRUE")?true:false;},getPromptService:function(){return Components.classes["@mozilla.org/embedcomp/prompt-service;1"].getService(Components.interfaces.nsIPromptService);},onLinkMenuItemCommand:function(b){var c=this.getPromptService();var a=this.deRemoteIt(gContextMenu.target.href);remoteItUtils.copyLinkToClipboard(a,null);},onNonLinkMenuItemCommand:function(b){var c=this.getPromptService();var a=this.deRemoteIt(gBrowser.currentURI.spec);remoteItUtils.copyLinkToClipboard(a,null);},deRemoteIt:function(a){return remoteItUtils.url_utils.deRemote(a);},remoteIt:function(a){return remoteItUtils.url_utils.convert(a);},handleException:function(a){alert(a);}};window.addEventListener("load",function(){remoteit.onLoad();},false);